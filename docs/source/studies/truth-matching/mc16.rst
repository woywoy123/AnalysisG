MC-16 Simulation Truth Matching
===============================

This section of the studies is dedicated to understanding whether the truth matching to tops is consistent.
Studies are detailed below and with their respective figures being listed for each study.
To reproduce these studies, samples need to be generated using an AnalysisTop derived codebase, which is linked below:

- https://github.com/woywoy123/BSM4tops-GNN-ntuples/tree/main

Studies
-------

* ZPrime:
  A study which investigates the resolution of the injected resonance for different mass points using decreasing truth information.
  The injected resonance mass is varied from 400 GeV to 1000 GeV (1 TeV), and the truth information is changed from truth-tops (perfect resolution) to detector jets (worst resolution).
  For the truth-jets, the truth neutrinos and leptons are used, if the tops decay leptonically.
  As for the jets case, the truth neutrinos and detector leptons are used. 

* DecayModes:
  A set of studies which investigates the decay modes of the resonant and spectator tops originating from a resonance. 
  The aim is to understand the decay modes of the tops and if there are any discriminating variables, which could be useful for identifying signal events.
  For this study, the event requires to have exactly two tops marked as originating from resonance and an additional two from spectator.

* TopKinematics:
  Studies relating to the kinematics of the tops produced from the resonance and their corresponding spectator counterparts.

* TopMatching:
  Studies relating to the truth matching scheme being used to assign reconstructed detector physics objects to individual top quarks (from truth).
  The aim is to investigate the best possible top reconstructibility available at different truth levels.
  Investigated levels involve the truth-top, truth-children, truth-jets with truth leptons/neutrinos, jets with truth leptons/neutrinos and jets with detector matched leptons and truth truth neutrinos.

* ChildrenKinematics:
  A set of studies relating to the decay children of truth-tops.
  These studies aim to investigate the kinematics of the decay products from resonance tops and compare these to background spectator tops.

* AddOnStudies:
  A set of specific studies relating to Elise's resonance reconstruction algorithm in the Same Sign Dilepton Channel.
  The reconstruction algorithm leverages the double neutrino reconstruction algorithm and uses a static top mass to select the neutrino solution which minimizes the difference between measured top-quark mass and predicted.

ZPrime
------

* Figure.1.a: 
  A matrix plot of the resonance using the truth-tops as input particles.
  The resonance mass points should be visible as distinct vertical lines since the truth tops have not undergone any detector smearing.

* Figure.1.b:
  A matrix plot of the resonance using the top-children as input particles.
  The resonance mass points should still be visible as distinct vertical lines, however some smearing is expected, since top-children undergo gluon radiation and the W-boson might emit a photon. 

* Figure.1.c:
  A matrix plot of the resonance using the truth-jets and truth-children (leptons and neutrinos only) as input particles.
  The resonance mass points should still be visible but each mass point might be overlapping due to initial detector smearing effects and track clustering when building truth-jets.

* Figure.1.d: 
  A matrix plot of the resonance using the jets, detector leptons and truth-children (neutrinos only) as input particles.
  The resonance mass points might be visible but each mass point might be overlapping due to detector smearing effects and track clustering when building jets.

DecayModes
----------

* Figure.2.a:
  An invariant mass distribution plot of the resonance's decay modes. 
  For sub-plots with hadronic and leptonic titles, the resonant tops both decay the same way.

* Figure.2.b:
  An invariant mass distribution plot of the resonance partitioned into same and opposite sign decay modes, where both tops-quarks decay leptonically.
  There should be no cases where the tops decay both leptonically with the same electric charge (Same-Sign should have no entries).

* Figure.2.c:
  An invariant mass distribution plot of the spectator tops being combined to create an mtt distribution.
  This is predominantly used to verify whether the distributions are different between resonant top pairs and spectator pairs.

* Figure.2.d: 
  An invariant mass distribution of combining spectator tops to form an mtt distribution. 
  The plot is partitioned into cases where the leptonic decay products produce same or opposite signed lepton charges.

* Figure.2.e: 
  A normalized fractional plot of the PDGID codes from tops decaying into their respective children. 
  The plot is divided by resonance and spectator top decay.

* Figure.2.f:
  A figure depicting the invariant mass of the resonance, when constraining the decay mode of one spectator and resonant top to be leptonically.
  The resulting decaying leptons can be categorized as being opposite and same signed, to further resolve the resonance.

TopKinematics
-------------

* Figure.3.a: 
  A figure depicting the transverse momenta of spectator and resonant tops.

* Figure.3.b:
  A figure depicting the energy of spectator and resonant tops.

* Figure.3.c: 
  A figure depicting the azimuthal angle of spectator and resonant tops.

* Figure.3.d: 
  A figure depicting the pseudorapidity of spectator and resonant tops.

* Figure.3.e: 
  A two dimensional heat-map of energy against transverse momenta for resonant tops.

* Figure.3.f: 
  A two dimensional heat-map of energy against transverse momenta for spectator tops.

* Figure.3.g: 
  A distribution plot of the :math:`\Delta R` between truth-top pairs.
  For plots with Resonance and Spectator titles, top-pairs are correctly assigned, otherwise they are labelled as a Mixture.

* Figure.3.h: 
  A distribution plot of the invariant mass produced when combining truth-top pairs.
  For plots with Resonance and Spectator titles, top-pairs are correctly assigned, otherwise they are labelled as a Mixture.

* Figure.3.j: 
  A two dimensional head-map of the invariant mass as a function of :math:`\Delta R`.
  For this plot, all possible truth-top pair permutations are used to compute the invariant mass and the :math:`\Delta R`.

TopMatching
-----------

* Figure.4.a:
  A figure depicting the top-quark invariant mass reconstruction, from the proposed truth matching scheme at different truth levels.
  The figure should illustrate a perfect peak at 172 GeV (truth-tops), with worsening resolution as more truth information is removed from the matching.
  The worst resolution is expected to be detector jets matched with detector leptons.

* Figure.4.b:
  A figure depicting the top-quark invariant mass reconstruction from truth children.
  The overall distribution is partitioned into the hadronic and leptonic decay modes of the tops.

* Figure.4.c:
  A figure depicting the top-quark invariant mass reconstruction from truth jets using the truth children, when the top-quark decayed leptonically.
  The overall distribution is partitioned into the hadronic and leptonic decay modes of the tops.

* Figure.4.d:
  A figure depicting the top-quark invariant mass reconstruction from jets using the truth children, when the top-quark decayed leptonically.
  The overall distribution is partitioned into the hadronic and leptonic decay modes of the tops.

* Figure.4.e:
  A figure depicting the top-quark invariant mass reconstruction from jets and matched detector leptons, when the top-quark decay leptonically only truth neutrinos are used.
  The overall distribution is partitioned into the hadronic and leptonic decay modes of the tops.

* Figure.4.f:
  A figure depicting the top-quark invariant mass using the proposed matching scheme and partitioning the underlying distributions into the number of truth jet contributions.
  For this study, only the leptonically decaying tops were being considered.

* Figure.4.g:
  A figure depicting the top-quark invariant mass using the proposed matching scheme and partitioning the underlying distributions into the number of truth jet contributions.
  For this study, only the hadronically decaying tops were being considered.

* Figure.4.h:
  A heat-map representation of the number of truth-jets contributing to the reconstructed invariant top-quark mass, for all decay modes.

* Figure.4.i:
  A figure depicting the top-quark invariant mass using the proposed matching scheme and partitioning the underlying distributions into the number of jet contributions.
  For this study, only the leptonically decaying tops were being considered.

* Figure.4.j:
  A figure depicting the top-quark invariant mass using the proposed matching scheme and partitioning the underlying distributions into the number of jet contributions.
  For this study, only the hadronically decaying tops were being considered.

* Figure.4.k:
  A heat-map representation of the number of jets contributing to the reconstructed invariant top-quark mass, for all decay modes.


ChildrenKinematics
------------------

* Figure.5.a:
  Transverse momenta distribution of the truth children.

* Figure.5.b:
  Transverse momenta distribution of the truth children originating from resonant top-quarks, partitioned into the PDGID's of the children.

* Figure.5.c:
  Transverse momenta distribution of the truth children originating from spectator top-quarks, partitioned into the PDGID's of the children.

* Figure.5.d:
  Pseudorapidity distribution of the truth children.

* Figure.5.e:
  Pseudorapidity distribution of the truth children originating from resonant top-quarks, partitioned into the PDGID's of the children.

* Figure.5.f:
  Pseudorapidity distribution of the truth children originating from spectator top-quarks, partitioned into the PDGID's of the children.

* Figure.5.g:
  Azimuthal angular distribution of the truth children.

* Figure.5.h:
  Azimuthal angular distribution of the truth children originating from resonant top-quarks, partitioned into the PDGID's of the children.

* Figure.5.i:
  Azimuthal angular distribution of the truth children originating from spectator top-quarks, partitioned into the PDGID's of the children.

* Figure.5.j:
  Energy distribution of the truth children.

* Figure.5.k:
  Energy distribution of the truth children originating from resonant top-quarks, partitioned into the PDGID's of the children.

* Figure.5.l:
  Energy distribution of the truth children originating from spectator top-quarks, partitioned into the PDGID's of the children.

* Figure.5.m:
  Transverse momenta of the top-quark truth children, segmented into their respective decay mode (leptonic and hadronic)

* Figure.5.n:
  Pseudorapidity of the top-quark truth children, segmented into their respective decay mode (leptonic and hadronic)

* Figure.5.o:
  Azimuthal angle of the top-quark truth children, segmented into their respective decay mode (leptonic and hadronic)

* Figure.5.p:
  Energy of the top-quark truth children, segmented into their respective decay mode (leptonic and hadronic)

* Figure.5.q:
  :math:`\Delta` R between truth children which originate from the same or different top-quarks. 
  Furthermore, the figure is segmented into whether the paired objects originate from spectator (SS), resonant top-pairs (RR) or a mixture (RS).

* Figure.5.r:
  The invariant mass of summed truth-children, which originate from mutual top-quarks, where the parent top-quarks can be spectators or resonance based.

* Figure.5.s:
  A two dimensional heat-map of Figures.5.q and Figures.5.r.

* Figure.5.t:
  A heat-map of the top-quark momenta and :math:`\Delta R` between truth-children.

* Figure.5.u:
  A heat-map of the top-quark energy and :math:`\Delta R` between truth-children.

* Figure.5.v:
  A distribution plot of the :math:`\Delta R` between originating top-quark and children, with plots being segmented by resonant/spectator and decay mode.

* Figure.5.w:
  A plot of the fractional Top-Quark Transverse Momenta dispersion distribution of decay children (Resonance).

* Figure.5.x:
  A plot of the fractional Top-Quark Transverse Momenta dispersion distribution of decay children (Spectator).

* Figure.5.y:
  A plot of the fractional Top-Quark Energy dispersion distribution of decay children (Resonance).

* Figure.5.z:
  A plot of the fractional Top-Quark Energy dispersion distribution of decay children (Spectator).







AddOnStudies
------------

* Figure.X.a: :math:`\Delta R` between leptonically decaying tops and respective b-quarks for possible b-quark/lepton pairs.
* Figure.X.b: Reconstructed Hadronic Top Mass. 
* Figure.X.c: Reconstructed Leptonic Top Mass.
* Figure.X.d: Reconstructed Resonance mass, derived from reconstructed top-quark candidates.
* Figure.x.e: Number of neutrino solutions.

