<?xml version='1.0' encoding='UTF-8' standalone='no'?>
<doxygen xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" xsi:noNamespaceSchemaLocation="compound.xsd" version="1.8.17">
  <compounddef id="rnn__model_8py" kind="file" language="Python">
    <compoundname>rnn_model.py</compoundname>
    <innernamespace refid="namespacernn__model">rnn_model</innernamespace>
    <briefdescription>
    </briefdescription>
    <detaileddescription>
    </detaileddescription>
    <programlisting>
<codeline lineno="1" refid="namespacernn__model" refkind="compound"><highlight class="comment">#import<sp/>torch</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="2"><highlight class="normal"></highlight><highlight class="keyword">import</highlight><highlight class="normal"><sp/>AnalysisG</highlight></codeline>
<codeline lineno="3"><highlight class="normal"></highlight><highlight class="keyword">from</highlight><highlight class="normal"><sp/>AnalysisG<sp/></highlight><highlight class="keyword">import</highlight><highlight class="normal"><sp/>Analysis</highlight></codeline>
<codeline lineno="4"><highlight class="normal"></highlight><highlight class="keyword">from</highlight><highlight class="normal"><sp/><ref refid="namespace_analysis_g_1_1core_1_1lossfx" kindref="compound">AnalysisG.core.lossfx</ref><sp/></highlight><highlight class="keyword">import</highlight><highlight class="normal"><sp/>OptimizerConfig</highlight></codeline>
<codeline lineno="5"><highlight class="normal"></highlight><highlight class="keyword">from</highlight><highlight class="normal"><sp/>AnalysisG.events.bsm_4tops.event_bsm_4tops<sp/></highlight><highlight class="keyword">import</highlight><highlight class="normal"><sp/>BSM4Tops</highlight></codeline>
<codeline lineno="6"><highlight class="normal"></highlight><highlight class="keyword">from</highlight><highlight class="normal"><sp/><ref refid="namespace_analysis_g_1_1events" kindref="compound">AnalysisG.events</ref><sp/></highlight><highlight class="keyword">import</highlight><highlight class="normal"><sp/>SSML_MC20</highlight></codeline>
<codeline lineno="7"><highlight class="normal"></highlight><highlight class="keyword">from</highlight><highlight class="normal"><sp/><ref refid="namespace_analysis_g_1_1graphs_1_1bsm__4tops" kindref="compound">AnalysisG.graphs.bsm_4tops</ref><sp/></highlight><highlight class="keyword">import</highlight><highlight class="normal"><sp/>*</highlight></codeline>
<codeline lineno="8"><highlight class="normal"></highlight><highlight class="keyword">from</highlight><highlight class="normal"><sp/><ref refid="namespace_analysis_g_1_1models" kindref="compound">AnalysisG.models</ref><sp/></highlight><highlight class="keyword">import</highlight><highlight class="normal"><sp/>*</highlight></codeline>
<codeline lineno="9"><highlight class="normal"></highlight></codeline>
<codeline lineno="10" refid="namespacernn__model_1a706106c65487126f42c412edebc4ba8a" refkind="member"><highlight class="normal">root1<sp/>=<sp/></highlight><highlight class="stringliteral">&quot;./samples/dilepton/*&quot;</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="11"><highlight class="normal"></highlight><highlight class="comment">#root1<sp/>=<sp/>&quot;/home/tnom6927/Downloads/mc20/user.bdong.503575.MGPy8EG.DAOD_PHYS.e8307_s3797_r13144_p6266.tom_sample_v01_output/user.bdong.41003314._000001.output.root&quot;</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="12"><highlight class="normal"></highlight><highlight class="comment">#root1<sp/>=<sp/>&quot;/home/tnom6927/Downloads/mc16/ttbar/user.tnommens.40945479._000001.output.root&quot;</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="13"><highlight class="normal"></highlight><highlight class="comment">#root1<sp/>=<sp/>&quot;/home/tnom6927/Downloads/mc16/ttH_tttt_m400/*&quot;</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="14"><highlight class="normal"></highlight></codeline>
<codeline lineno="15" refid="namespacernn__model_1abbe51a062dd6352b999d29bbdff24ee7" refkind="member"><highlight class="normal">x<sp/>=<sp/>BSM4Tops()</highlight></codeline>
<codeline lineno="16"><highlight class="normal"></highlight><highlight class="comment">#x<sp/>=<sp/>SSML_MC20()</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="17"><highlight class="normal"></highlight><highlight class="comment">#tt<sp/>=<sp/>GraphChildren()</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="18"><highlight class="normal"></highlight><highlight class="comment">#tt<sp/>=<sp/>GraphTruthJets()</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="19"><highlight class="normal"></highlight><highlight class="comment">#tt<sp/>=<sp/>GraphDetector()</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="20" refid="namespacernn__model_1a0b2ba28fd934d9a75a8e0494c70bd322" refkind="member"><highlight class="normal">tt<sp/>=<sp/>GraphTruthJets()</highlight></codeline>
<codeline lineno="21"><highlight class="normal"></highlight></codeline>
<codeline lineno="22" refid="namespacernn__model_1a9f4e388fbf8accc0434484d8989dca0d" refkind="member"><highlight class="normal">params<sp/>=<sp/>[</highlight></codeline>
<codeline lineno="23"><highlight class="normal"><sp/><sp/><sp/><sp/>(</highlight><highlight class="stringliteral">&quot;MRK-1&quot;</highlight><highlight class="normal">,<sp/></highlight><highlight class="stringliteral">&quot;adam&quot;</highlight><highlight class="normal">,<sp/>{</highlight><highlight class="stringliteral">&quot;lr&quot;</highlight><highlight class="normal"><sp/>:<sp/>1e-4}),</highlight></codeline>
<codeline lineno="24"><highlight class="normal"></highlight><highlight class="comment">#<sp/><sp/><sp/><sp/>(&quot;MRK-2&quot;,<sp/>&quot;adam&quot;,<sp/>{&quot;lr&quot;<sp/>:<sp/>1e-6}),</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="25"><highlight class="normal"></highlight><highlight class="comment">#<sp/><sp/><sp/><sp/>(&quot;MRK-3&quot;,<sp/>&quot;adam&quot;,<sp/>{&quot;lr&quot;<sp/>:<sp/>1e-6,<sp/>&quot;amsgrad&quot;<sp/>:<sp/>True}),</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="26"><highlight class="normal"></highlight><highlight class="comment">#<sp/><sp/><sp/><sp/>(&quot;MRK-4&quot;,<sp/>&quot;sgd&quot;<sp/>,<sp/>{&quot;lr&quot;<sp/>:<sp/>1e-3}),</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="27"><highlight class="normal"></highlight><highlight class="comment">#<sp/><sp/><sp/><sp/>(&quot;MRK-5&quot;,<sp/>&quot;sgd&quot;,<sp/>{&quot;lr&quot;<sp/>:<sp/>1e-6}),</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="28"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="comment">#<sp/><sp/><sp/><sp/>(&quot;MRK-6&quot;,<sp/>&quot;sgd&quot;,<sp/>{&quot;lr&quot;<sp/>:<sp/>1e-4,<sp/>&quot;momentum&quot;<sp/>:<sp/>0.1}),</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="29"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="comment">#<sp/><sp/><sp/><sp/>(&quot;MRK-7&quot;,<sp/>&quot;sgd&quot;,<sp/>{&quot;lr&quot;<sp/>:<sp/>1e-6,<sp/>&quot;momentum&quot;<sp/>:<sp/>0.01,<sp/>&quot;dampening&quot;<sp/>:<sp/>0.01})</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="30"><highlight class="normal">]</highlight></codeline>
<codeline lineno="31"><highlight class="normal"></highlight></codeline>
<codeline lineno="32" refid="namespacernn__model_1a02742dc37f689941f20da7492b88915b" refkind="member"><highlight class="normal">trains<sp/>=<sp/>[]</highlight></codeline>
<codeline lineno="33" refid="namespacernn__model_1a58db7c3c74b21ba47638e7eb03bc009a" refkind="member"><highlight class="normal">optims<sp/>=<sp/>[]</highlight></codeline>
<codeline lineno="34" refid="namespacernn__model_1a6000e4c68e07910f5bcd49cedf22afa4" refkind="member"><highlight class="normal">ana<sp/>=<sp/>Analysis()</highlight></codeline>
<codeline lineno="35" refid="namespacernn__model_1a19e60fd57ec76804d163e73cb83e2e7d" refkind="member"><highlight class="normal">p<sp/>=<sp/>0</highlight></codeline>
<codeline lineno="36" refid="namespacernn__model_1adb2a219b00c736d006b49d8b12ee884e" refkind="member"><highlight class="normal">n<sp/>=<sp/>2</highlight></codeline>
<codeline lineno="37"><highlight class="normal"></highlight><highlight class="keywordflow">for</highlight><highlight class="normal"><sp/>k<sp/></highlight><highlight class="keywordflow">in</highlight><highlight class="normal"><sp/>params:</highlight></codeline>
<codeline lineno="38"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="comment">#m1<sp/>=<sp/>RecursiveGraphNeuralNetwork()</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="39" refid="namespacernn__model_1a3d5657621f343e53150d482e59f6abed" refkind="member"><highlight class="normal"><sp/><sp/><sp/><sp/>m1<sp/>=<sp/>Grift()</highlight></codeline>
<codeline lineno="40"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="comment">#m1.PageRank<sp/>=<sp/>True</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="41" refid="namespacernn__model_1a62ff80d30796219bd61e994a434d64c3" refkind="member"><highlight class="normal"><sp/><sp/><sp/><sp/>m1.o_edge<sp/><sp/>=<sp/>{</highlight></codeline>
<codeline lineno="42"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="stringliteral">&quot;top_edge&quot;</highlight><highlight class="normal"><sp/>:<sp/></highlight><highlight class="stringliteral">&quot;CrossEntropyLoss&quot;</highlight><highlight class="normal">,</highlight></codeline>
<codeline lineno="43"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="stringliteral">&quot;res_edge&quot;</highlight><highlight class="normal"><sp/>:<sp/></highlight><highlight class="stringliteral">&quot;CrossEntropyLoss&quot;</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="44"><highlight class="normal"><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="45" refid="namespacernn__model_1aa69b566d5f2914b539d7cf95d0bc66bb" refkind="member"><highlight class="normal"><sp/><sp/><sp/><sp/>m1.o_graph<sp/>=<sp/>{</highlight></codeline>
<codeline lineno="46"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="stringliteral">&quot;ntops&quot;</highlight><highlight class="normal"><sp/><sp/>:<sp/></highlight><highlight class="stringliteral">&quot;CrossEntropyLoss&quot;</highlight><highlight class="normal">,</highlight></codeline>
<codeline lineno="47"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="stringliteral">&quot;signal&quot;</highlight><highlight class="normal"><sp/>:<sp/></highlight><highlight class="stringliteral">&quot;CrossEntropyLoss&quot;</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="48"><highlight class="normal"><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="49" refid="namespacernn__model_1a74bbed39e89277f27a336ad6463c2475" refkind="member"><highlight class="normal"><sp/><sp/><sp/><sp/>m1.i_node<sp/><sp/>=<sp/>[</highlight><highlight class="stringliteral">&quot;pt&quot;</highlight><highlight class="normal">,<sp/></highlight><highlight class="stringliteral">&quot;eta&quot;</highlight><highlight class="normal">,<sp/></highlight><highlight class="stringliteral">&quot;phi&quot;</highlight><highlight class="normal">,<sp/></highlight><highlight class="stringliteral">&quot;energy&quot;</highlight><highlight class="normal">,<sp/></highlight><highlight class="stringliteral">&quot;charge&quot;</highlight><highlight class="normal">]</highlight></codeline>
<codeline lineno="50" refid="namespacernn__model_1a9503619c8f7d166b2e90dd4ca8888b8c" refkind="member"><highlight class="normal"><sp/><sp/><sp/><sp/>m1.i_graph<sp/>=<sp/>[</highlight><highlight class="stringliteral">&quot;met&quot;</highlight><highlight class="normal">,<sp/></highlight><highlight class="stringliteral">&quot;phi&quot;</highlight><highlight class="normal">]</highlight></codeline>
<codeline lineno="51" refid="namespacernn__model_1a82ba533bb59e100d9155b0ff74120af2" refkind="member"><highlight class="normal"><sp/><sp/><sp/><sp/>m1.device<sp/><sp/>=<sp/></highlight><highlight class="stringliteral">&quot;cuda:&quot;</highlight><highlight class="normal"><sp/>+<sp/>str(p%n)</highlight></codeline>
<codeline lineno="52"><highlight class="normal"></highlight></codeline>
<codeline lineno="53" refid="namespacernn__model_1ac15ce1ff2b40f2421c8bfb0d7659f495" refkind="member"><highlight class="normal"><sp/><sp/><sp/><sp/>opti<sp/>=<sp/>OptimizerConfig()</highlight></codeline>
<codeline lineno="54" refid="namespacernn__model_1a828ca7c93fa2c84015e8eb871b2573e9" refkind="member"><highlight class="normal"><sp/><sp/><sp/><sp/>opti.Optimizer<sp/>=<sp/>k[1]</highlight></codeline>
<codeline lineno="55"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">for</highlight><highlight class="normal"><sp/>t<sp/></highlight><highlight class="keywordflow">in</highlight><highlight class="normal"><sp/>k[2]:<sp/>setattr(opti,<sp/>t,<sp/>k[2][t])</highlight></codeline>
<codeline lineno="56"><highlight class="normal"><sp/><sp/><sp/><sp/>p+=1</highlight></codeline>
<codeline lineno="57"><highlight class="normal"><sp/><sp/><sp/><sp/>trains.append(m1)</highlight></codeline>
<codeline lineno="58"><highlight class="normal"><sp/><sp/><sp/><sp/>optims.append(opti)</highlight></codeline>
<codeline lineno="59"><highlight class="normal"></highlight></codeline>
<codeline lineno="60"><highlight class="normal">ana.AddSamples(root1,<sp/></highlight><highlight class="stringliteral">&quot;tmp&quot;</highlight><highlight class="normal">)</highlight></codeline>
<codeline lineno="61" refid="namespacernn__model_1aaa98103454af85a054e56a5b7b5ebd0d" refkind="member"><highlight class="normal">ana.Threads<sp/>=<sp/>4</highlight></codeline>
<codeline lineno="62"><highlight class="normal"></highlight><highlight class="comment">#ana.AddSamples(ttZ,<sp/>&quot;ttZ&quot;)</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="63"><highlight class="normal">ana.AddEvent(x,<sp/></highlight><highlight class="stringliteral">&quot;tmp&quot;</highlight><highlight class="normal">)</highlight></codeline>
<codeline lineno="64"><highlight class="normal">ana.AddGraph(tt,<sp/></highlight><highlight class="stringliteral">&quot;tmp&quot;</highlight><highlight class="normal">)</highlight></codeline>
<codeline lineno="65"><highlight class="normal"></highlight></codeline>
<codeline lineno="66"><highlight class="normal"></highlight><highlight class="comment">#ana.AddEvent(x,<sp/>&quot;ttZ&quot;)</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="67"><highlight class="normal"></highlight><highlight class="comment">#ana.AddGraph(tt,<sp/>&quot;ttZ&quot;)</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="68"><highlight class="normal"></highlight></codeline>
<codeline lineno="69"><highlight class="normal"></highlight><highlight class="keywordflow">for</highlight><highlight class="normal"><sp/>i<sp/></highlight><highlight class="keywordflow">in</highlight><highlight class="normal"><sp/>range(len(optims)):<sp/>ana.AddModel(trains[i],<sp/>optims[i],<sp/>params[0][0]<sp/>+<sp/></highlight><highlight class="stringliteral">&quot;-&quot;</highlight><highlight class="normal">+str(i))</highlight></codeline>
<codeline lineno="70"><highlight class="normal"></highlight></codeline>
<codeline lineno="71" refid="namespacernn__model_1a7d74056fbe675e7d383bceb9c545b616" refkind="member"><highlight class="normal">ana.kFolds<sp/>=<sp/>10</highlight></codeline>
<codeline lineno="72" refid="namespacernn__model_1a708ff40033477eab46384dd231fa61d0" refkind="member"><highlight class="normal">ana.Epochs<sp/>=<sp/>100</highlight></codeline>
<codeline lineno="73" refid="namespacernn__model_1a1f74d889a8b5b5cd8c6dab254b271e24" refkind="member"><highlight class="normal">ana.TrainingDataset<sp/>=<sp/></highlight><highlight class="stringliteral">&quot;./ProjectName/sample.h5&quot;</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="74" refid="namespacernn__model_1a15e3d1305c837e3b1d70c56c4c28e55e" refkind="member"><highlight class="normal">ana.Targets<sp/>=<sp/>[</highlight><highlight class="stringliteral">&quot;top_edge&quot;</highlight><highlight class="normal">,<sp/></highlight><highlight class="stringliteral">&quot;res_edge&quot;</highlight><highlight class="normal">]</highlight></codeline>
<codeline lineno="75" refid="namespacernn__model_1aef60e1038ff9187428e7c351bb956ca2" refkind="member"><highlight class="normal">ana.GraphCache<sp/>=<sp/></highlight><highlight class="stringliteral">&quot;./ProjectName/&quot;</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="76" refid="namespacernn__model_1a0ebf997eb513b615ba07c85bae104464" refkind="member"><highlight class="normal">ana.kFold<sp/>=<sp/>[1,<sp/>2,<sp/>3,<sp/>4]<sp/></highlight><highlight class="comment">#6,<sp/>7,<sp/>3,<sp/>5,<sp/>9]</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="77" refid="namespacernn__model_1a94a4d0d344013c58a102f5d6013d6fc3" refkind="member"><highlight class="normal">ana.MaxRange<sp/>=<sp/>1500</highlight></codeline>
<codeline lineno="78" refid="namespacernn__model_1aa936ea0b9b9dbb38f8e0d3c83154c29d" refkind="member"><highlight class="normal">ana.TrainSize<sp/>=<sp/>80</highlight></codeline>
<codeline lineno="79" refid="namespacernn__model_1aca64d3028b048aa26b3f56998f861a17" refkind="member"><highlight class="normal">ana.BatchSize<sp/>=<sp/>4</highlight></codeline>
<codeline lineno="80" refid="namespacernn__model_1a5ddfcfdc6aa374bfeaf75308732013e9" refkind="member"><highlight class="normal">ana.ContinueTraining<sp/>=<sp/></highlight><highlight class="keyword">True</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="81"><highlight class="normal"></highlight><highlight class="comment">#ana.SumOfWeightsTreeName<sp/>=<sp/>&quot;sumWeights&quot;</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="82"><highlight class="normal"></highlight><highlight class="comment">#ana.FetchMeta<sp/>=<sp/>True</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="83" refid="namespacernn__model_1a8e8d2e0ff35e8c29d0adf5b6c73054a8" refkind="member"><highlight class="normal">ana.DebugMode<sp/><sp/>=<sp/></highlight><highlight class="keyword">False</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="84" refid="namespacernn__model_1a3230a7fc21b780bf06bd0ae8fb75eab9" refkind="member"><highlight class="normal">ana.Validation<sp/>=<sp/></highlight><highlight class="keyword">False</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="85" refid="namespacernn__model_1ab699872a949080309f1ccc03f28a404c" refkind="member"><highlight class="normal">ana.Evaluation<sp/>=<sp/></highlight><highlight class="keyword">False</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="86"><highlight class="normal">ana.Start()</highlight></codeline>
<codeline lineno="87"><highlight class="normal"></highlight></codeline>
    </programlisting>
    <location file="/workspaces/AnalysisG/test/rnn_model.py"/>
  </compounddef>
</doxygen>
