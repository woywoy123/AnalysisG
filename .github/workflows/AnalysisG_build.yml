name: Building AnalysisG
on:
  pull_request:
      branches:
        - "master"

      paths-ignore:
        - '**.md'
        - 'docs'
        - 'scripts'

  push:
      branches:
        - "master"

      paths-ignore:
        - '**.md'
        - 'docs'
        - 'scripts'

defaults:
  run:
    shell: bash
  
jobs:
  build:
    runs-on: ubuntu-latest
    name: building
    steps:      
      - name: "Checkout the repo"
        uses: "actions/checkout@v3"

      - name: "Building singularity"
        run: |
          sudo apt-get update
          sudo apt-get install -y build-essential 
          sudo apt-get install -y libssl-dev
          sudo apt-get install -y uuid-dev
          sudo apt-get install -y libgpgme11-dev
          sudo apt-get install -y squashfs-tools
          sudo apt-get install -y libseccomp-dev
          sudo apt-get install -y pkg-config
          sudo wget -O- http://neuro.debian.net/lists/xenial.us-ca.full | sudo tee /etc/apt/sources.list.d/neurodebian.sources.list 
          sudo apt-key adv --recv-keys --keyserver hkp://pool.sks-keyservers.net:80 0xA5D32F012649A5A9 
          sudo apt-get update
          sudo apt-get install -y singularity-container
          singularity build singularity.sif singularity.def
